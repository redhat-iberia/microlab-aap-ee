<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Ejecución microlab :: Summit Connect 2024 - Microlab Debugging EE</title>
    <link rel="canonical" href="https://github.com/redhat-iberia/microlab-aap-ee/microlab-debugging-ee/02-deploy.html">
    <link rel="prev" href="01-setup.html">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img src="../_/img/RHDLogo.svg" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="https://github.com/redhat-iberia/microlab-aap-ee">Summit Connect 2024 - Microlab Debugging EE</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://developers.redhat.com/ebooks/" target="_blank">Books</a>
        <a class="navbar-item" href="https://developers.redhat.com/cheatsheets/" target="_blank">Cheat Sheets</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/kubernetes-tutorial/" target="_blank">Kubernetes</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/istio-tutorial/" target="_blank">Istio</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/quarkus-tutorial/" target="_blank">Quarkus</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/knative-tutorial/" target="_blank">Knative</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/tekton-tutorial/" target="_blank">Tekton</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="microlab-debugging-ee" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html"></a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="01-setup.html">1. Microlab Info</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#controller">Controller Access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#ssh">SSH Access</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="02-deploy.html">2. Microlab Guide</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Summit Connect 2024 - Microlab Debugging EE</a></li>
    <li><a href="02-deploy.html">2. Microlab Guide</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/redhat-iberia/microlab-aap-ee/edit/master/documentation/modules/ROOT/pages/02-deploy.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Ejecución microlab</h1>
<div class="sect2">
<h3 id="ejecucion"><a class="anchor" href="#ejecucion"></a>Ejecución del template para la creación de objetos en AAP</h3>
<div class="paragraph">
<p>Lo primero que debemos hacer es ejecutar el Job Template <strong>[OPS] Añadir usuario a Operaciones</strong> para crear un nuevo usuario en la organización y darle permisos para ver los elementos que contiene.</p>
</div>
<div class="paragraph">
<p>En la <a href="https://aap24-controller01.sc24.workshops//#/templates">interfaz web del Controller</a>, verás un Job Template
nombrado <strong>[OPS] Añadir usuario a Operaciones</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/job_launch.png" alt="job launch">
</div>
</div>
<div class="paragraph">
<p>Ejecutamos el Job Template y rellenamos los campos que nos pide el formulario.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/survey.png" alt="survey">
</div>
</div>
<div class="paragraph">
<p>Una vez la ejecución del Job Template haya fallado (esa era la intención) vamos a ver cual es el error a través de la interfaz Web.</p>
</div>
<div class="paragraph">
<p>En los logs podremos ver que el problema viene por la falta de una colección que no existe dentro del execution environment.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/error_log.png" alt="error log">
</div>
</div>
<div class="paragraph">
<p>Para solucionar esto deberemos cambiar el execution environment que usa el Job Template para lanzarse.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Para este microlab hemos descargado las imágenes de los Execution Environment en el registro interno de la máquina, simplificando el escenario para no hacerlo demasiado extenso. En un escenario productivo haríamos uso de Ansible Automation Hub para el almacenamiento y publicación de éstas imágenes.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="collection"><a class="anchor" href="#collection"></a>Buscando la coleccion en las imágenes</h3>
<div class="paragraph">
<p>En la <a href="https://aap24-controller01.sc24.workshops/#/execution_environments">interfaz web del Controller, sección de <em>Execution Environmets</em></a>, verás cuales tenemos disponibles:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/exec_envs.png" alt="exec envs">
</div>
</div>
<div class="paragraph">
<p>Con esta información no vamos a poder saber cual de ellas tiene la colección que necesitamos, pero disponemos de una herramienta de exploración a través del terminal.</p>
</div>
<div class="paragraph">
<p>Nos conectamos a la máquina a través de ssh.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ssh root@aap24-controller01.sc24.workshops</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ahora vamos a usar el comando <strong><em>ansible-navigator</em></strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ansible-navigator

 0│Welcome
 1│————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
 2│
 3│Some things you can try from here:
 4│- :collections                                    Explore available collections
 5│- :config                                         Explore the current ansible configuration
 6│- :doc &lt;plugin&gt;                                   Review documentation for a module or plugin
 7│- :help                                           Show the main help page
 8│- :images                                         Explore execution environment images
 9│- :inventory -i &lt;inventory&gt;                       Explore an inventory
10│- :log                                            Review the application log
11│- :lint &lt;file or directory&gt;                       Lint Ansible/YAML files (experimental)
12│- :open                                           Open current page in the editor
13│- :replay                                         Explore a previous run using a playbook artifact
14│- :run &lt;playbook&gt; -i &lt;inventory&gt;                  Run a playbook in interactive mode
15│- :settings                                       Review the current ansible-navigator settings
16│- :quit                                           Quit the application
17│
18│happy automating,
19│
20│-winston</code></pre>
</div>
</div>
<div class="paragraph">
<p>Seleccionamos la opción <strong><em>images</em></strong>, escribiendo <strong><em>:images</em></strong> en el terminal, y se nos mostrarán las imagenes que tenemos en el registry interno.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">Image                                                Tag             Execution environment                            Created                   Size
0│ee-supported-rhel8                                   latest          True                                             2 weeks ago               1.53 GB
1│ee-supported-rhel8-casc                              latest          True                                             11 days ago               1.62 GB
2│gitlab-ee                                            latest          False                                            4 weeks ago               3.45 GB</code></pre>
</div>
</div>
<div class="paragraph">
<p>Elegimos la imagen que queramos inspeccionar, en este caso la <em>ee-supported-rhel8</em>, pulsando el número <strong><em>0</em></strong>.  En la siguiente pantalla, seleccionamos la opción <strong><em>2</em></strong> para que nos muestre las collecciones instaladas en el Execution Environment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">Image: ee-supported-rhel8:latest (primary)                                 Description
0│Image information                                                          Information collected from image inspection
1│General information                                                        OS and python version information
2│Ansible version and collections                                            Information about ansible and ansible collections
3│Python packages                                                            Information about python and python packages
4│Operating system packages                                                  Information about operating system packages
5│Everything                                                                 All image information</code></pre>
</div>
</div>
<div class="paragraph">
<p>Una vez seleccionada la imagen nos mostrará todas las colecciones instaladas en el Execution Environment</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Image: ee-supported-rhel8:latest (primary) (Information about ansible and ansible collections)
 0│---
 1│ansible:
 2│  collections:
 3│    details:
 4│	 amazon.aws: 6.4.0
 5│	 ansible.controller: 4.5.10
 6│	 ansible.netcommon: 6.0.0
 7│	 ansible.network: 3.0.0
 8│	 ansible.posix: 1.5.4
 9│	 ansible.scm: 2.0.0
10│	 ansible.security: 2.0.0
11│	 ansible.snmp: 2.0.0
12│	 ansible.utils: 3.0.0
13│	 ansible.windows: 1.14.0
14│	 ansible.yang: 2.0.0
15│	 arista.eos: 7.0.0
16│	 cisco.asa: 5.0.0
17│	 cisco.ios: 6.1.0
18│	 cisco.iosxr: 7.0.0
19│	 cisco.nxos: 6.0.0
20│	 cloud.common: 2.1.2
21│	 cloud.terraform: 1.1.1
22│	 frr.frr: 2.0.2
23│	 ibm.qradar: 3.0.0
24│	 junipernetworks.junos: 6.0.0
25│	 kubernetes.core: 3.0.1
26│	 microsoft.ad: 1.1.0
27│	 openvswitch.openvswitch: 2.1.1
28│	 redhat.amq_broker: 1.3.0
29│	 redhat.data_grid: 1.3.1
30│	 redhat.eap: 1.3.1
31│	 redhat.insights: 1.2.2
32│	 redhat.jws: 2.0.0
33│	 redhat.openshift: 2.3.0
34│	 redhat.openshift_virtualization: 1.2.3
35│	 redhat.redhat_csp_download: 1.2.2
36│	 redhat.rhbk: 2.2.2
37│	 redhat.rhel_idm: 1.10.0
38│	 redhat.rhel_system_roles: 1.21.1
39│	 redhat.rhv: 2.4.2
40│	 redhat.runtimes_common: 1.1.3
41│	 redhat.sap_install: 1.2.1
42│	 redhat.satellite: 3.10.0
43│	 redhat.satellite_operations: 1.3.0
44│	 redhat.sso: 1.3.0
45│	 sap.sap_operations: 1.0.4
46│	 servicenow.itsm: 2.1.0
47│	 splunk.es: 3.0.0
48│	 trendmicro.deepsec: 3.0.0
49│	 vmware.vmware_rest: 2.3.1
50│	 vyos.vyos: 4.0.2
51│  version:
52│    details: ansible [core 2.15.12]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="update-template"><a class="anchor" href="#update-template"></a>Modificando el EE del Job Template</h3>
<div class="paragraph">
<p>Ahora que sabemos cual es la imagen que debemos usar volvemos a la <a href="https://aap24-controller01.sc24.workshops/#/jobs">interfaz web del Controller, sección de Job Templates</a>, editamos el <strong>[OPS] Añadir usuario a Operaciones</strong> y seleccionamos el EE necesario.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/modify_ee.png" alt="modify ee">
</div>
</div>
<div class="paragraph">
<p>Volvemos a lanzar el Job Template y comprobamos que se ejecuta de manera correcta</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/job_run.png" alt="job run">
</div>
</div>
<div class="paragraph">
<p>Ahora podemos comprobar que el usuario que hemos creado tiene los permisos correctos para poder realizar su trabajo.</p>
</div>
<div class="paragraph">
<p>Hacemos login en la consola del Controller con el usuario que acabamos de crear y ejecutamos uno de los Job Templates que tenemos disponibles.</p>
</div>
<div class="paragraph">
<p><strong>[OPS] Reiniciar servicio</strong>
<strong>[OPS] Reiniciar servidor</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="resumen"><a class="anchor" href="#resumen"></a>Resumen</h3>
<div class="paragraph">
<p>Durante este microlab hemos querido hacer foco en la importancia de la abtracción a la hora de crear código delegando las dependencias de paquetes y módulos en la creación del Execution Environment, lo que nos proporciona una portabilidad absoluta a la hora de ejecutar nuestro código, y en una de las herramientas de desarrollo incluídas en Ansible Automation Platform como es <strong><em>ansible-navigator</em></strong>.</p>
</div>
<div class="paragraph">
<p>Obviamente ésta no es la única (hay más de 20 projectos de comunidad), pero si quieres ampliar la información sobre las demás herramientas incluídas puedes pasar por nuestro stand y preguntar a uno de nuestros expertos.</p>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="01-setup.html">1. Microlab Info</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
